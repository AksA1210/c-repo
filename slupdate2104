
#include <iostream>
using namespace std;

class items
{
    string name;
	int code;
	float price;
	int quantity;
	float total;
	public:
	  items()
	  {
	      name=0;
	      code=0;
	      price=0;
	      quantity=0;
	      total=0;
	  }
	  void add()
	  {
	      cout<<"Item name : ";
		  cin>>itemName;
		  cout<<"Item code : ";
		  cin>>itemCode;
		  cout<<"Item quantity : ";
		  cin>>itemQuantity;
		  cout<<"Item price : ";
		  cin>>itemPrice;
	  } 
	  void display_details()
	  {
	      cout<<code<<"\t\t"<<name<<"\t\t"<<price<<"\t\t"<<quantity<<endl;
	  }
	  void alterQuantity(int decrement)
	  {
	      quantity = quantity - decrement;
	  }
	  int check_code()
	  {
	      return code;
	  }
	  int check_quantity()
	  {
		return quantity;
	  }
	  void update_quantity(int new_quantity)
	  {
	      quantity = quantity + new_quantity;
	  }
	  float generateSum()
	  {
	      return quantity*price;
	  }
 	  void new_quantity(int new_quantity)
 	  {
 	      quantity = new_quantity;
	  }
};

int main()
{
	items *stock = new items[20];
	items *shoppingList = new items[20];
	int stockCount = 0;
	int shoppingCount = 0;
	int option,choice;
	int keyPosition;
	bool found = false;
	do 
	{
	    cout<<"Choose any option from the following : "<<endl;
		cout<<"1.Add item to the stock"<<endl;
		cout<<"2.Delete item from the stock"<<endl;
		cout<<"3.Update item in the stock"<<endl;
		cout<<"4.Display items in the stock"<<endl;
		cout<<"5.Purchase item"<<endl;
		cout<<"6.Generate bill"<<endl;
		cout<<"Enter your choice : "<<" ";
		cin>>choice;
		switch (choice) 
		{
			case 1:
				stock[stockCount].add();
				cout<<"---------Item added successfully--------"<<endl;
				stockCount++;
				break;
			case 2:
			{
				int searchKey;
				cout<<"Item Code : ";
				cin>>searchKey;
				for (int i = 0; i < stockCount; ++i) {
					if (searchKey==stock[i].checkCode()) {
						found = true;
						keyPosition = i;
						cout<<"--------Item deleted successfully--------"<<endl;
						break;
					}
				}
				if (!found)
				{
					cout<<"Invalid code"<<endl;
				}
				else
				{
					for (int i = keyPosition; i < stockCount; ++i)
					{
						stock[i]=stock[i+1];
					}
					stockCount--;
				}
			}
			break;
			case 3:
			{
				bool found = false;
				cout<<"Item Code\tItem Name\tItem Price\tItem Quantity"<<endl;
				for (int i = 0; i < stockCount; ++i) 
				{
					stock[i].displayItem();
				}
				int searchKey;
				cout<<"Enter the Item Code : ";
				cin>>searchKey;
				for (int i = 0; i < stockCount; ++i) {
					if (searchKey==stock[i].checkCode()) {
						int x;
						cout<<"Enter the Amount of Quantity : ";
						cin>>x;
						stock[i].updateQuantity(x);
						found = true;
						cout<<"Successfully Updated"<<endl;
						break;
					}
				}
				if(!found){
					cout<<"Invalid Code"<<endl;
				}
			}
				break;
			case 4:
			{
				cout<<"Item Code\tItem Name\tItem Price\tItem Quantity"<<endl;
				for (int i = 0; i < stockCount; ++i) 
				{
					stock[i].display_details();
			    }
			}    
			break;
			case 5:
			{
			    do
			    {
			        bool purchased = false;
				    int tempItemCode,tempItemQuantity;
				    cout<<"Enter the Item Code"<<endl;
				    cin>>tempItemCode;
				    cout<<"Quantity you want to purchase"<<endl;
				    cin>>tempItemQuantity;
				    for (int i = 0; i < stockCount; i++) 
				    {
				        if (tempItemCode==stock[i].checkCode())
				        {
				            if(tempItemQuantity>stock[i].checkQuantity())
				            {
				                cout<<"Insufficient Stock"<<endl;
							    break;
				            } 
				            cout<<"Came"<<endl;
						    purchased = true;
						    shoppingList[shoppingCount]=stock[i];
						    shoppingList[shoppingCount].newQuantity(tempItemQuantity);
						    stock[i].alterQuantity(tempItemQuantity);
						    shoppingList[shoppingCount].displayItem();
						    shoppingCount++;
						    break;
				        }
				}
			}	
			break;
			case 6:
			{
			    float total;
			    cout<<"Your Purchase Bill"<<endl;
				cout<<"Item Code\tItem Name\tItem Price\tItem Quantity"<<endl;
			    for (int i = 0; i < shoppingCount; i++) 
			    {
					shoppingList[i].display_details();
					total = total+ shoppingList[i].generateSum();
				}
					cout<<"Total Price = "<<total<<endl;
				}
			}
			break;
			case 7:
			{
			    break;
                default:cout<<"Error ! Please try again "<<endl;
			    
			}
		}
		
		char p;
        if (choice!=7)
        {
            cout<<"Do you want to continue(y/n)? : "<<" ";
            cin>>p;
            if (p=='n')
            {
                choice=7;
            }
        }
    } while (choice!=7);
	return 0;
}
